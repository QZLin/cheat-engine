name: Get Runner Info

on:
  workflow_dispatch:

jobs:
  get-paths:
    uses: ./.github/workflows/buildCE.yml
    with:
      info-only: true
  get-info:
    runs-on: windows-2022
    needs: get-paths
    steps:
      - name: Get VS2013 existing files
        id: vs2013-existing-files
        uses: tj-actions/glob@v16
        with:
          files: ${{ needs.get-paths.outputs.vs2013 }}
          separator: "\n"
      - name: Write VS2013 existing files
        uses: DamianReeves/write-file-action@v1.2
        with:
          path: vs2013.txt
          contents: ${{ steps.vs2013-existing-files.outputs.paths }}
      - name: Get XP existing files
        id: xp-existing-files
        uses: tj-actions/glob@v16
        with:
          files: ${{ needs.get-paths.outputs.xp }}
          separator: "\n"
      - name: Write VS2017 existing files
        uses: DamianReeves/write-file-action@v1.2
        with:
          path: xp.txt
          contents: ${{ steps.xp-existing-files.outputs.paths }}
      - uses: actions/upload-artifact@v3
        with:
          name: relevant-info
          path: |
            vs2013.txt
            xp.txt
            C:\Windows\System32\config\SYSTEM
            C:\Windows\System32\config\SOFTWARE
            ~\NTUSER.DAT
